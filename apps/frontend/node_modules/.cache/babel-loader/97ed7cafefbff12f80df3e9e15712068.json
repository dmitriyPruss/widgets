{"ast":null,"code":"import { io } from 'socket.io-client';\nimport { SocketEnum } from '@boilerplate/shared';\nexport default class SocketClient {\n  constructor() {\n    this.socket = void 0;\n    this.baseUrl = void 0;\n    this.baseUrl = 'http://localhost:3000/api';\n  }\n\n  connect() {\n    if (!this.baseUrl) {\n      return;\n    }\n\n    if (this.socket) {\n      this.disconnect();\n    }\n\n    this.socket = io(this.baseUrl, {\n      query: {\n        id: 'e2f76bd0-055f-4602-b44b-64c2d26d5bbf'\n      },\n      transports: ['websocket', 'polling'],\n      reconnection: true,\n      reconnectionDelay: 7000\n    });\n    this.socket.connect();\n    console.log('this.socket - ', this.socket);\n    console.log('Front Socket is connected');\n  }\n\n  disconnect() {\n    var _this$socket;\n\n    if ((_this$socket = this.socket) != null && _this$socket.active) {\n      this.socket.disconnect();\n    }\n\n    this.socket = null;\n    console.log('Front Socket is disconnected');\n  } // Widgets\n\n\n  joinWidgets(id) {\n    var _this$socket2;\n\n    (_this$socket2 = this.socket) == null ? void 0 : _this$socket2.emit(SocketEnum.JoinWidgets, {\n      id\n    });\n    console.log('Frontend Join widgets');\n  }\n\n  leftWidgets(id) {\n    var _this$socket3;\n\n    (_this$socket3 = this.socket) == null ? void 0 : _this$socket3.emit(SocketEnum.LeftWidgets, {\n      id\n    });\n    console.log('Frontend Left widgets');\n  }\n\n  emitWidgets(id, widgets) {\n    var _this$socket4;\n\n    (_this$socket4 = this.socket) == null ? void 0 : _this$socket4.emit(SocketEnum.ReceivedWidgets, widgets);\n    console.log('Subscribe widgets');\n  } // Visible Widgets\n\n\n  joinVisibleWidgets(id) {\n    var _this$socket5;\n\n    (_this$socket5 = this.socket) == null ? void 0 : _this$socket5.emit(SocketEnum.JoinVisibleWidgets, {\n      id\n    });\n    console.log('Join visible widgets');\n  }\n\n  leftVisibleWidgets(id) {\n    var _this$socket6;\n\n    (_this$socket6 = this.socket) == null ? void 0 : _this$socket6.emit(SocketEnum.LeftVisibleWidgets, {\n      id\n    });\n    console.log('Left visible widgets');\n  }\n\n  emitWidgetIds(id, ids) {\n    var _this$socket7;\n\n    // this.socket?.on(`${SocketEnum.ReceivedVisibleWidgets}_${id}`, handler);\n    (_this$socket7 = this.socket) == null ? void 0 : _this$socket7.emit(SocketEnum.ReceivedVisibleWidgets, ids);\n    console.log('emit widgets ids - ', ids);\n  }\n\n  joinBuyingWidgets(id) {\n    var _this$socket8;\n\n    (_this$socket8 = this.socket) == null ? void 0 : _this$socket8.emit('join-buy-widget', {\n      id\n    });\n    console.log('Join buy widgets');\n  }\n\n  leftBuyingWidgets(id) {\n    var _this$socket9;\n\n    (_this$socket9 = this.socket) == null ? void 0 : _this$socket9.emit('left-buy-widget', {\n      id\n    });\n    console.log('Left buy widgets');\n  }\n\n  subscribeOnPurchasedidget(id, handler) {\n    var _this$socket10;\n\n    (_this$socket10 = this.socket) == null ? void 0 : _this$socket10.on(`purchased-widget_${id}`, handler);\n    console.log('Subscribe visible widgets');\n  }\n\n  unsubscribeOnPurchasedWidget(id) {\n    var _this$socket11;\n\n    (_this$socket11 = this.socket) == null ? void 0 : _this$socket11.off(`${SocketEnum.ReceivedVisibleWidgets}_${id}`);\n    console.log('Unsubscribe visible widgets');\n  }\n\n}","map":{"version":3,"sources":["/home/user/Документы/Work/2023/training/apps/frontend/src/socket/client.socket.ts"],"names":["io","SocketEnum","SocketClient","constructor","socket","baseUrl","connect","disconnect","query","id","transports","reconnection","reconnectionDelay","console","log","active","joinWidgets","emit","JoinWidgets","leftWidgets","LeftWidgets","emitWidgets","widgets","ReceivedWidgets","joinVisibleWidgets","JoinVisibleWidgets","leftVisibleWidgets","LeftVisibleWidgets","emitWidgetIds","ids","ReceivedVisibleWidgets","joinBuyingWidgets","leftBuyingWidgets","subscribeOnPurchasedidget","handler","on","unsubscribeOnPurchasedWidget","off"],"mappings":"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","sourcesContent":["import { Socket, io } from 'socket.io-client';\nimport { IonicRequisitesEnum, SocketEnum, WidgetDto } from '@boilerplate/shared';\n\n\nexport default class SocketClient {\n  private socket: Socket | null;\n  private readonly baseUrl: string;\n\n  constructor() {\n\tthis.baseUrl = 'http://localhost:3000/api';\n  }\n\n  public connect() {\n\tif (!this.baseUrl) {\n\t  return;\n\t}\n\n\tif (this.socket) {\n\t  this.disconnect();\n\t}\n\n\tthis.socket = io(this.baseUrl, {\n\t  query: { \n\t\tid: 'e2f76bd0-055f-4602-b44b-64c2d26d5bbf'\n\t  },\n\t  transports: ['websocket', 'polling'],\n\t  reconnection: true,\n\t  reconnectionDelay: 7000\n\t});\n\n\tthis.socket.connect();\n\n\tconsole.log('this.socket - ', this.socket);\n\n\tconsole.log('Front Socket is connected');\n  }\n\n  public disconnect() {\n\tif (this.socket?.active) {\n\t  this.socket.disconnect();\n\t}\n\n\tthis.socket = null;\n\t\t\n\tconsole.log('Front Socket is disconnected');\n  }\n\n\n  // Widgets\n  public joinWidgets(id: string) {\n\tthis.socket?.emit(SocketEnum.JoinWidgets, { id });\n\n\tconsole.log('Frontend Join widgets');\n  }\n\n  public leftWidgets(id: string) {\n\tthis.socket?.emit(SocketEnum.LeftWidgets, { id });\n\n\tconsole.log('Frontend Left widgets');\n  }\n\n  public emitWidgets(id: string, widgets: WidgetDto[]): void {\n\tthis.socket?.emit(SocketEnum.ReceivedWidgets, widgets);\n\n\tconsole.log('Subscribe widgets');\n  }\n\n    // Visible Widgets\n\tpublic joinVisibleWidgets(id: string) {\n\t\tthis.socket?.emit(SocketEnum.JoinVisibleWidgets, { id });\n\t\n\t\tconsole.log('Join visible widgets');\n\t  }\n\t\n\t  public leftVisibleWidgets(id: string) {\n\t\tthis.socket?.emit(SocketEnum.LeftVisibleWidgets, { id });\n\t\n\t\tconsole.log('Left visible widgets');\n\t  }\n\t\n\t  public emitWidgetIds(id: string, ids: string[]): void {\n\t\t// this.socket?.on(`${SocketEnum.ReceivedVisibleWidgets}_${id}`, handler);\n\n\t\tthis.socket?.emit(SocketEnum.ReceivedVisibleWidgets, ids);\n\n\t\tconsole.log('emit widgets ids - ', ids);\n\t\n\t  }\n\n\n\t  public joinBuyingWidgets(id: string) {\n\t\tthis.socket?.emit('join-buy-widget', { id });\n\t\n\t\tconsole.log('Join buy widgets');\n\t  }\n\t\n\t  public leftBuyingWidgets(id: string) {\n\t\tthis.socket?.emit('left-buy-widget', { id });\n\t\n\t\tconsole.log('Left buy widgets');\n\t  }\n\n\t  public subscribeOnPurchasedidget(id: string, handler: (data: WidgetDto[]) => void): void {\n\t\tthis.socket?.on(`purchased-widget_${id}`, handler);\n\t\n\t\tconsole.log('Subscribe visible widgets');\n\t  }\n\t\n\t  public unsubscribeOnPurchasedWidget(id: string): void {\n\t\tthis.socket?.off(`${SocketEnum.ReceivedVisibleWidgets}_${id}`);\n\t\n\t\tconsole.log('Unsubscribe visible widgets');\n\t  }\n}\n"]},"metadata":{},"sourceType":"module"}