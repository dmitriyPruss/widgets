{"ast":null,"code":"import { io } from 'socket.io-client';\nimport { SocketEnum } from '@boilerplate/shared';\nexport default class SocketClient {\n  constructor() {\n    this.socket = void 0;\n    this.baseUrl = void 0;\n    this.baseUrl = 'http://localhost:3000/api';\n  }\n\n  connect() {\n    if (!this.baseUrl) {\n      return;\n    }\n\n    if (this.socket) {\n      this.disconnect();\n    }\n\n    this.socket = io(this.baseUrl, {\n      query: {\n        id: 'e2f76bd0-055f-4602-b44b-64c2d26d5bbf'\n      },\n      transports: ['websocket', 'polling'],\n      reconnection: true,\n      reconnectionDelay: 7000\n    });\n    this.socket.connect();\n    console.log('Front Socket is connected');\n  }\n\n  disconnect() {\n    var _this$socket;\n\n    if ((_this$socket = this.socket) != null && _this$socket.active) {\n      this.socket.disconnect();\n    }\n\n    this.socket = null;\n    console.log('Front Socket is disconnected');\n  } // Player\n\n\n  joinPlayer(id) {\n    var _this$socket2;\n\n    (_this$socket2 = this.socket) == null ? void 0 : _this$socket2.emit(SocketEnum.JoinPlayer, {\n      id\n    });\n    console.log('Join player');\n  }\n\n  leftPlayer(id) {\n    var _this$socket3;\n\n    (_this$socket3 = this.socket) == null ? void 0 : _this$socket3.emit(SocketEnum.LeftPlayer, {\n      id\n    });\n    console.log('Left player');\n  }\n\n  subscribeOnNewPlaybackUrl(id, handler) {\n    var _this$socket4;\n\n    (_this$socket4 = this.socket) == null ? void 0 : _this$socket4.on(`${SocketEnum.ReceivedPlaybackUrl}_${id}`, handler);\n    console.log('Subscribe on stream');\n  }\n\n  unsubscribeOnNewPlaybackUrl(id) {\n    var _this$socket5;\n\n    (_this$socket5 = this.socket) == null ? void 0 : _this$socket5.off(`${SocketEnum.ReceivedPlaybackUrl}_${id}`);\n    console.log('Unsubscribe from stream');\n  } // Widgets\n\n\n  joinWidgets(id) {\n    var _this$socket6;\n\n    (_this$socket6 = this.socket) == null ? void 0 : _this$socket6.emit(SocketEnum.JoinWidgets, {\n      id\n    });\n    console.log('Join widgets');\n  }\n\n  leftWidgets(id) {\n    var _this$socket7;\n\n    (_this$socket7 = this.socket) == null ? void 0 : _this$socket7.emit(SocketEnum.LeftWidgets, {\n      id\n    });\n    console.log('Left widgets');\n  }\n\n  subscribeOnNewWidgets(id, handler) {\n    var _this$socket8;\n\n    (_this$socket8 = this.socket) == null ? void 0 : _this$socket8.on(`${SocketEnum.ReceivedWidgets}_${id}`, handler);\n    console.log('Subscribe widgets');\n  }\n\n  unsubscribeOnNewWidgets(id) {\n    var _this$socket9;\n\n    (_this$socket9 = this.socket) == null ? void 0 : _this$socket9.off(`${SocketEnum.ReceivedWidgets}_${id}`);\n    console.log('Unsubscribe widgets');\n  } // Visible Widgets\n\n\n  joinVisibleWidgets(id) {\n    var _this$socket10;\n\n    (_this$socket10 = this.socket) == null ? void 0 : _this$socket10.emit(SocketEnum.JoinVisibleWidgets, {\n      id\n    });\n    console.log('Join visible widgets');\n  }\n\n  leftVisibleWidgets(id) {\n    var _this$socket11;\n\n    (_this$socket11 = this.socket) == null ? void 0 : _this$socket11.emit(SocketEnum.LeftVisibleWidgets, {\n      id\n    });\n    console.log('Left visible widgets');\n  }\n\n  subscribeOnNewVisibleWidgets(id, handler) {\n    var _this$socket12;\n\n    (_this$socket12 = this.socket) == null ? void 0 : _this$socket12.on(`${SocketEnum.ReceivedVisibleWidgets}_${id}`, handler);\n    console.log('Subscribe visible widgets');\n  }\n\n  unsubscribeOnNewVisibleWidgets(id) {\n    var _this$socket13;\n\n    (_this$socket13 = this.socket) == null ? void 0 : _this$socket13.off(`${SocketEnum.ReceivedVisibleWidgets}_${id}`);\n    console.log('Unsubscribe visible widgets');\n  }\n\n}","map":{"version":3,"sources":["/home/user/Документы/Work/2023/training/apps/frontend/src/socket/client.socket.ts"],"names":["io","SocketEnum","SocketClient","constructor","socket","baseUrl","connect","disconnect","query","id","transports","reconnection","reconnectionDelay","console","log","active","joinPlayer","emit","JoinPlayer","leftPlayer","LeftPlayer","subscribeOnNewPlaybackUrl","handler","on","ReceivedPlaybackUrl","unsubscribeOnNewPlaybackUrl","off","joinWidgets","JoinWidgets","leftWidgets","LeftWidgets","subscribeOnNewWidgets","ReceivedWidgets","unsubscribeOnNewWidgets","joinVisibleWidgets","JoinVisibleWidgets","leftVisibleWidgets","LeftVisibleWidgets","subscribeOnNewVisibleWidgets","ReceivedVisibleWidgets","unsubscribeOnNewVisibleWidgets"],"mappings":"AAAA,SAAiBA,EAAjB,QAA2B,kBAA3B;AACA,SAA8BC,UAA9B,QAA2D,qBAA3D;AAGA,eAAe,MAAMC,YAAN,CAAmB;AAIhCC,EAAAA,WAAW,GAAG;AAAA,SAHNC,MAGM;AAAA,SAFGC,OAEH;AACf,SAAKA,OAAL,GAAe,2BAAf;AACE;;AAEMC,EAAAA,OAAO,GAAG;AAClB,QAAI,CAAC,KAAKD,OAAV,EAAmB;AACjB;AACD;;AAED,QAAI,KAAKD,MAAT,EAAiB;AACf,WAAKG,UAAL;AACD;;AAED,SAAKH,MAAL,GAAcJ,EAAE,CAAC,KAAKK,OAAN,EAAe;AAC7BG,MAAAA,KAAK,EAAE;AACRC,QAAAA,EAAE,EAAE;AADI,OADsB;AAI7BC,MAAAA,UAAU,EAAE,CAAC,WAAD,EAAc,SAAd,CAJiB;AAK7BC,MAAAA,YAAY,EAAE,IALe;AAM7BC,MAAAA,iBAAiB,EAAE;AANU,KAAf,CAAhB;AASA,SAAKR,MAAL,CAAYE,OAAZ;AAEAO,IAAAA,OAAO,CAACC,GAAR,CAAY,2BAAZ;AACE;;AAEMP,EAAAA,UAAU,GAAG;AAAA;;AACrB,wBAAI,KAAKH,MAAT,aAAI,aAAaW,MAAjB,EAAyB;AACvB,WAAKX,MAAL,CAAYG,UAAZ;AACD;;AAED,SAAKH,MAAL,GAAc,IAAd;AAEAS,IAAAA,OAAO,CAACC,GAAR,CAAY,8BAAZ;AACE,GAvC+B,CAyChC;;;AACOE,EAAAA,UAAU,CAACP,EAAD,EAAa;AAAA;;AAC/B,0BAAKL,MAAL,mCAAaa,IAAb,CAAkBhB,UAAU,CAACiB,UAA7B,EAAyC;AAAET,MAAAA;AAAF,KAAzC;AAEAI,IAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ;AACE;;AAEMK,EAAAA,UAAU,CAACV,EAAD,EAAa;AAAA;;AAC/B,0BAAKL,MAAL,mCAAaa,IAAb,CAAkBhB,UAAU,CAACmB,UAA7B,EAAyC;AAAEX,MAAAA;AAAF,KAAzC;AAEAI,IAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ;AACE;;AAEMO,EAAAA,yBAAyB,CAACZ,EAAD,EAAaa,OAAb,EAAoD;AAAA;;AACrF,0BAAKlB,MAAL,mCAAamB,EAAb,CAAiB,GAAEtB,UAAU,CAACuB,mBAAoB,IAAGf,EAAG,EAAxD,EAA2Da,OAA3D;AAEAT,IAAAA,OAAO,CAACC,GAAR,CAAY,qBAAZ;AACE;;AAEMW,EAAAA,2BAA2B,CAAChB,EAAD,EAAmB;AAAA;;AACtD,0BAAKL,MAAL,mCAAasB,GAAb,CAAkB,GAAEzB,UAAU,CAACuB,mBAAoB,IAAGf,EAAG,EAAzD;AAEAI,IAAAA,OAAO,CAACC,GAAR,CAAY,yBAAZ;AACE,GAhE+B,CAmEhC;;;AACOa,EAAAA,WAAW,CAAClB,EAAD,EAAa;AAAA;;AAChC,0BAAKL,MAAL,mCAAaa,IAAb,CAAkBhB,UAAU,CAAC2B,WAA7B,EAA0C;AAAEnB,MAAAA;AAAF,KAA1C;AAEAI,IAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ;AACE;;AAEMe,EAAAA,WAAW,CAACpB,EAAD,EAAa;AAAA;;AAChC,0BAAKL,MAAL,mCAAaa,IAAb,CAAkBhB,UAAU,CAAC6B,WAA7B,EAA0C;AAAErB,MAAAA;AAAF,KAA1C;AAEAI,IAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ;AACE;;AAEMiB,EAAAA,qBAAqB,CAACtB,EAAD,EAAaa,OAAb,EAAyD;AAAA;;AACtF,0BAAKlB,MAAL,mCAAamB,EAAb,CAAiB,GAAEtB,UAAU,CAAC+B,eAAgB,IAAGvB,EAAG,EAApD,EAAuDa,OAAvD;AAEAT,IAAAA,OAAO,CAACC,GAAR,CAAY,mBAAZ;AACE;;AAEMmB,EAAAA,uBAAuB,CAACxB,EAAD,EAAmB;AAAA;;AAClD,0BAAKL,MAAL,mCAAasB,GAAb,CAAkB,GAAEzB,UAAU,CAAC+B,eAAgB,IAAGvB,EAAG,EAArD;AAEAI,IAAAA,OAAO,CAACC,GAAR,CAAY,qBAAZ;AACE,GA1F+B,CA4F9B;;;AACIoB,EAAAA,kBAAkB,CAACzB,EAAD,EAAa;AAAA;;AACrC,2BAAKL,MAAL,oCAAaa,IAAb,CAAkBhB,UAAU,CAACkC,kBAA7B,EAAiD;AAAE1B,MAAAA;AAAF,KAAjD;AAEAI,IAAAA,OAAO,CAACC,GAAR,CAAY,sBAAZ;AACE;;AAEMsB,EAAAA,kBAAkB,CAAC3B,EAAD,EAAa;AAAA;;AACvC,2BAAKL,MAAL,oCAAaa,IAAb,CAAkBhB,UAAU,CAACoC,kBAA7B,EAAiD;AAAE5B,MAAAA;AAAF,KAAjD;AAEAI,IAAAA,OAAO,CAACC,GAAR,CAAY,sBAAZ;AACE;;AAEMwB,EAAAA,4BAA4B,CAAC7B,EAAD,EAAaa,OAAb,EAAyD;AAAA;;AAC7F,2BAAKlB,MAAL,oCAAamB,EAAb,CAAiB,GAAEtB,UAAU,CAACsC,sBAAuB,IAAG9B,EAAG,EAA3D,EAA8Da,OAA9D;AAEAT,IAAAA,OAAO,CAACC,GAAR,CAAY,2BAAZ;AACE;;AAEM0B,EAAAA,8BAA8B,CAAC/B,EAAD,EAAmB;AAAA;;AACzD,2BAAKL,MAAL,oCAAasB,GAAb,CAAkB,GAAEzB,UAAU,CAACsC,sBAAuB,IAAG9B,EAAG,EAA5D;AAEAI,IAAAA,OAAO,CAACC,GAAR,CAAY,6BAAZ;AACE;;AAnH8B","sourcesContent":["import { Socket, io } from 'socket.io-client';\nimport { IonicRequisitesEnum, SocketEnum, WidgetDto } from '@boilerplate/shared';\n\n\nexport default class SocketClient {\n  private socket: Socket | null;\n  private readonly baseUrl: string;\n\n  constructor() {\n\tthis.baseUrl = 'http://localhost:3000/api';\n  }\n\n  public connect() {\n\tif (!this.baseUrl) {\n\t  return;\n\t}\n\n\tif (this.socket) {\n\t  this.disconnect();\n\t}\n\n\tthis.socket = io(this.baseUrl, {\n\t  query: { \n\t\tid: 'e2f76bd0-055f-4602-b44b-64c2d26d5bbf'\n\t  },\n\t  transports: ['websocket', 'polling'],\n\t  reconnection: true,\n\t  reconnectionDelay: 7000\n\t});\n\n\tthis.socket.connect();\n\n\tconsole.log('Front Socket is connected');\n  }\n\n  public disconnect() {\n\tif (this.socket?.active) {\n\t  this.socket.disconnect();\n\t}\n\n\tthis.socket = null;\n\t\t\n\tconsole.log('Front Socket is disconnected');\n  }\n\n  // Player\n  public joinPlayer(id: string) {\n\tthis.socket?.emit(SocketEnum.JoinPlayer, { id });\n\t\n\tconsole.log('Join player');\n  }\n\n  public leftPlayer(id: string) {\n\tthis.socket?.emit(SocketEnum.LeftPlayer, { id });\n\t\n\tconsole.log('Left player');\n  }\n\n  public subscribeOnNewPlaybackUrl(id: string, handler: (data: string) => void): void {\n\tthis.socket?.on(`${SocketEnum.ReceivedPlaybackUrl}_${id}`, handler);\n\n\tconsole.log('Subscribe on stream');\n  }\n\n  public unsubscribeOnNewPlaybackUrl(id: string): void {\n\tthis.socket?.off(`${SocketEnum.ReceivedPlaybackUrl}_${id}`);\n\n\tconsole.log('Unsubscribe from stream');\n  }\n\n\n  // Widgets\n  public joinWidgets(id: string) {\n\tthis.socket?.emit(SocketEnum.JoinWidgets, { id });\n\n\tconsole.log('Join widgets');\n  }\n\n  public leftWidgets(id: string) {\n\tthis.socket?.emit(SocketEnum.LeftWidgets, { id });\n\n\tconsole.log('Left widgets');\n  }\n\n  public subscribeOnNewWidgets(id: string, handler: (data: WidgetDto[]) => void): void {\n\tthis.socket?.on(`${SocketEnum.ReceivedWidgets}_${id}`, handler);\n\n\tconsole.log('Subscribe widgets');\n  }\n\n  public unsubscribeOnNewWidgets(id: string): void {\n\tthis.socket?.off(`${SocketEnum.ReceivedWidgets}_${id}`);\n\n\tconsole.log('Unsubscribe widgets');\n  }\n\n    // Visible Widgets\n\tpublic joinVisibleWidgets(id: string) {\n\t\tthis.socket?.emit(SocketEnum.JoinVisibleWidgets, { id });\n\t\n\t\tconsole.log('Join visible widgets');\n\t  }\n\t\n\t  public leftVisibleWidgets(id: string) {\n\t\tthis.socket?.emit(SocketEnum.LeftVisibleWidgets, { id });\n\t\n\t\tconsole.log('Left visible widgets');\n\t  }\n\t\n\t  public subscribeOnNewVisibleWidgets(id: string, handler: (data: WidgetDto[]) => void): void {\n\t\tthis.socket?.on(`${SocketEnum.ReceivedVisibleWidgets}_${id}`, handler);\n\t\n\t\tconsole.log('Subscribe visible widgets');\n\t  }\n\t\n\t  public unsubscribeOnNewVisibleWidgets(id: string): void {\n\t\tthis.socket?.off(`${SocketEnum.ReceivedVisibleWidgets}_${id}`);\n\t\n\t\tconsole.log('Unsubscribe visible widgets');\n\t  }\n}\n"]},"metadata":{},"sourceType":"module"}