{"ast":null,"code":"var _jsxFileName = \"/home/user/\\u0414\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\\u044B/Work/2023/training/apps/frontend/src/components/product-card/product-card.component.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useCallback, useEffect, useMemo } from 'react';\nimport ReactDOM from 'react-dom';\nimport { Box, Link, Typography } from '@mui/material';\nimport { getEmptyImage } from 'react-dnd-html5-backend';\nimport { useDrag } from 'react-dnd';\nimport { cardHeight, cardWidth, maxLeftCoord, maxTopCoord, offset } from '../../constants/product-card.constants';\nimport { linkStyle } from './product-card.styles';\nimport ProductCardLayer from '../product-card-layer/product-card-layer.component';\nimport getCardCoord from '../../utils/get-card-coord.utils';\nimport { jsxDEV as _jsxDEV } from \"@emotion/react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"@emotion/react/jsx-dev-runtime\";\n\nconst ProductCard = ({\n  widget,\n  setCurrentCoords\n}) => {\n  _s();\n\n  const videoContainerNode = document.getElementById('video-container');\n  const videoContainerCoords = useMemo(() => videoContainerNode ? videoContainerNode.getBoundingClientRect() : null, [videoContainerNode]);\n  const {\n    id,\n    left,\n    top\n  } = widget;\n  const [{\n    isDragging\n  }, drag, preview] = useDrag(() => ({\n    type: 'prod-card',\n    item: {\n      id,\n      left,\n      top\n    },\n    collect: monitor => ({\n      isDragging: !!monitor.isDragging()\n    })\n  }), [id, left, top]);\n  const showProductCardLayer = useCallback(widget => {\n    if (!videoContainerNode) {\n      return null;\n    }\n\n    if (!isDragging) {\n      return null;\n    }\n\n    return /*#__PURE__*/ReactDOM.createPortal(_jsxDEV(ProductCardLayer, {\n      widget: widget,\n      setCurrentCoords: setCurrentCoords\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 7\n    }, this), videoContainerNode);\n  }, [videoContainerNode, isDragging, setCurrentCoords]);\n  useEffect(() => {\n    preview(getEmptyImage(), {\n      captureDraggingState: true\n    });\n  }, [preview]);\n\n  if (!videoContainerCoords) {\n    return null;\n  }\n\n  const topCoord = top > 0 ? top : 1;\n  const leftCoord = left > 0 ? left : 1;\n  const topCard = getCardCoord(maxTopCoord, topCoord, cardHeight, offset);\n  const leftCard = getCardCoord(maxLeftCoord, leftCoord, cardWidth, offset);\n  const transform = `translate(${leftCard}px, ${topCard}px)`;\n  return _jsxDEV(_Fragment, {\n    children: [showProductCardLayer(widget), _jsxDEV(Box, {\n      ref: drag,\n      p: 1.5,\n      boxSizing: \"border-box\",\n      position: \"absolute\",\n      width: cardWidth,\n      top: topCard,\n      left: leftCard,\n      bgcolor: \"#fff\",\n      borderRadius: 3,\n      boxShadow: \"1px 1px 8px 0 grey\",\n      zIndex: 3,\n      display: \"flex\",\n      flexDirection: \"column\",\n      id: widget.id,\n      sx: {\n        transform,\n        opacity: isDragging ? 0 : 1,\n        height: isDragging ? 0 : cardHeight\n      },\n      children: [_jsxDEV(Typography, {\n        variant: \"h5\",\n        children: widget == null ? void 0 : widget.title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 9\n      }, this), _jsxDEV(Typography, {\n        fontSize: \"18px\",\n        children: [\"Price: \", widget == null ? void 0 : widget.price, \" $\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 9\n      }, this), _jsxDEV(Box, {\n        display: \"flex\",\n        justifyContent: \"flex-end\",\n        children: _jsxDEV(Link, {\n          variant: \"button\",\n          underline: \"none\",\n          href: widget == null ? void 0 : widget.url,\n          target: \"blank\",\n          sx: linkStyle,\n          children: \"SHOP\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 9\n      }, this)]\n    }, widget.id, true, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n\n_s(ProductCard, \"FENpiN/lNgIIE3ee1jmXTZLwc/g=\", false, function () {\n  return [useDrag];\n});\n\n_c = ProductCard;\nexport default ProductCard;\n\nvar _c;\n\n$RefreshReg$(_c, \"ProductCard\");","map":{"version":3,"sources":["/home/user/Документы/Work/2023/training/apps/frontend/src/components/product-card/product-card.component.tsx"],"names":["React","useCallback","useEffect","useMemo","ReactDOM","Box","Link","Typography","getEmptyImage","useDrag","cardHeight","cardWidth","maxLeftCoord","maxTopCoord","offset","linkStyle","ProductCardLayer","getCardCoord","ProductCard","widget","setCurrentCoords","videoContainerNode","document","getElementById","videoContainerCoords","getBoundingClientRect","id","left","top","isDragging","drag","preview","type","item","collect","monitor","showProductCardLayer","createPortal","captureDraggingState","topCoord","leftCoord","topCard","leftCard","transform","opacity","height","title","price","url"],"mappings":"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","sourcesContent":["import React, { FC, useCallback, useEffect, useMemo } from 'react';\nimport ReactDOM from 'react-dom';\nimport { Box, Link, Typography  } from '@mui/material';\nimport { getEmptyImage } from 'react-dnd-html5-backend'\nimport { useDrag } from 'react-dnd';\nimport { \n  cardHeight, \n  cardWidth, \n  maxLeftCoord, \n  maxTopCoord, \n  offset \n} from '../../constants/product-card.constants';\nimport { IProductCardProps, IWidgetItem } from './product-card.types';\nimport { linkStyle } from './product-card.styles';\nimport ProductCardLayer from '../product-card-layer/product-card-layer.component';\nimport getCardCoord from '../../utils/get-card-coord.utils';\n\n\nconst ProductCard: FC<IProductCardProps> = (\n  { widget, setCurrentCoords }: IProductCardProps\n) => {\n  const videoContainerNode = document.getElementById('video-container');\n\n  const videoContainerCoords = useMemo(\n    () => videoContainerNode ? videoContainerNode.getBoundingClientRect() : null, \n    [videoContainerNode]\n  );\n\n  const { id, left, top } = widget;\n\n  const [{ isDragging }, drag, preview] = useDrag(\n    () => ({\n      type: 'prod-card',\n      item: { id, left, top },\n      collect: (monitor) => ({\n        isDragging: !!monitor.isDragging()\n      }),\n    }),\n    [id, left, top]\n  );\n\n  const showProductCardLayer = useCallback((widget: IWidgetItem) => {\n    if (!videoContainerNode) {\n      return null;\n    }\n\n    if (!isDragging) {\n      return null;\n    }\n\n    return ReactDOM.createPortal(\n      <ProductCardLayer widget={widget} setCurrentCoords={setCurrentCoords} />,\n      videoContainerNode\n    );\n  }, [videoContainerNode, isDragging, setCurrentCoords]);\n\n  useEffect(() => {\n    preview(getEmptyImage(), { captureDraggingState: true })\n  }, [preview])\n\n  if (!videoContainerCoords) {\n    return null;\n  }\n\n  const topCoord = top > 0 ? top : 1;\n  const leftCoord = left > 0 ? left : 1;\n\n  const topCard = getCardCoord(maxTopCoord, topCoord, cardHeight, offset);\n\n  const leftCard = getCardCoord(maxLeftCoord, leftCoord, cardWidth, offset);\n\n  const transform = `translate(${leftCard}px, ${topCard}px)`;\n\n  return (\n    <>\n      {showProductCardLayer(widget)}\n      <Box\n        ref={drag}\n        p={1.5} \n        boxSizing=\"border-box\" \n        position=\"absolute\" \n        width={cardWidth}\n        top={topCard}\n        left={leftCard} \n        bgcolor=\"#fff\" \n        borderRadius={3} \n        boxShadow=\"1px 1px 8px 0 grey\" \n        zIndex={3}\n        display=\"flex\"\n        flexDirection=\"column\"\n        key={widget.id}\n        id={widget.id}\n        sx={{\n          transform,\n          opacity: isDragging ? 0 : 1,\n          height: isDragging ? 0 : cardHeight,\n        }}\n      >       \n        <Typography variant=\"h5\">{widget?.title}</Typography>\n        <Typography fontSize=\"18px\">Price: {widget?.price} $</Typography> \n        <Box display=\"flex\" justifyContent=\"flex-end\">  \n          <Link \n            variant=\"button\" \n            underline=\"none\" \n            href={widget?.url} \n            target=\"blank\"\n            sx={linkStyle} \n          >\n            SHOP\n          </Link> \n        </Box> \n      </Box>\n    </>\n  )\n};\n\nexport default ProductCard;"]},"metadata":{},"sourceType":"module"}